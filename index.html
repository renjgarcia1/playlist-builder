<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link type="text/css" href="styles.css" rel="stylesheet" />
    <link href="dist/sp-bootstrap.min.css" rel="stylesheet" media="screen">
    <title>Playlist Builder</title>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<div class="navbar navbar-default" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="index.html">
        <span class="navbar-title">Playlist Builder</span>
      </a>
    </div>
    <div class="navbar-collapse collapse">
      <a href="http://www.spotify.com" class="btn btn-primary navbar-btn navbar-right">Get Spotify</a>
    </div>
  </div>
</div>

<div id='top' class="jumbotron">
  <div class="container-fluid" id="jumbo-dialog">
    <h1 id='attitle'>Playlist Builder</h1>
    <p class="lead">The best DJ is everybody.</p>
    <p id='ttext'>
      The Playlist Miner aggregrates the top tracks from the most popular public playlists on Spotify that match your search criteria. Looking for the best <i>workout</i> tracks? Enter the term <i>workout</i> and we'll find the tracks that have appeared most frequently in workout playlists.
    </p>
    <div class='intro-form' id='login-form'>
      <p>To get started, login with your Spotify credentials.</p>
      <p><a class="btn btn-primary btn-lg" id='login-button' role="button">Login with Spotify</a></p>
    </div>
    <div id="search-form" class="intro-form row">
      <div class="col-xs-offset-1 col-xs-10 col-sm-offset-3 col-sm-6">
        <input type="text" class="form-control input-lg" id="playlist-terms" placeholder="'work out' OR workout " value="">
        <br>
        <button class="btn btn-primary btn-lg" id='go' role="button">Find playlists</button>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid work">
  <div id='info' class="h1 text-center"></div>

  <div class="results" id='playlist-table'>
    <h1>Matching Playlists for <span class='keywords'></span></h1>
    <div class="progress">
      <div id='playlist-progress' class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><span class="sr-only"></span></div>
    </div>
    <div class='button-row'>
      We've found <span class="total-playlists"> </span> matching playlists with a total of <span class='total-tracks'> 0 </span> tracks.
      <br>
      <div id='fetch-tracks-ready'>
        Press <b>Find top tracks</b> to build a playlist of the top tracks across all of these playlists or go back and <a href="index.html">refine your query</a>.
        <div class='obutton-row'>
          <button id='fetch-tracks' class='btn btn-primary'>Find top tracks</button>
        </div>
      </div>
    </div>

    <table class="table table-striped table-bordered">
      <thead>
        <tr> <th style="width:5%"> # </th> <th style="width: 85%"> Playlist name </th> <th style="width:10%"> # Tracks </th> </tr>
      </thead>
      <tbody id="playlist-items"> </tbody>
    </table>
  </div>

  <div class="results" id='track-table'>
    <h1> <a id='playlist-name'>Top <span class='keywords'> </span> Tracks</a></h1>
    <div class="button-row">
      <div id='fetching-tracks'>
        Aggregating <span id='tt-total-tracks'> </span> tracks from all of the <span class="keywords"></span> playlists.
        <p>You can stop this at any time, but the longer you wait, the better your results.</p>
        <button id='stop-button' class='padded-button stop-button btn btn-primary'>stop</button>
      </div>
      <div id='ready-to-save'>
        Here are the top 100 <span class='keywords'></span> tracks. You can save these as your own Spotify playlist by clicking the button.
        <br>
        <button id="save-button" class="padded-button btn btn-primary btn-lg">Save Playlist to Spotify</button>
      </div>
    </div>

    <div class="progress">
      <div id='track-progress' class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"><span class="sr-only"></span></div>
    </div>

    <label><input id='norm-for-pop' type='checkbox'> Prefer more distinctive <span class='keywords'></span> tracks </label>
    <table class="table table-striped table-bordered">
      <thead>
        <tr> <th style="width:5%"> # </th> <th style="width:40%"> Title </th> <th style="width:35%"> Artist </th> <th style="width:10%"> Score</th> </tr>
      </thead>
      <tbody id="track-items"> </tbody>
    </table>
  </div>
</div>

<div id="footer">
  <div class="container text-center">
    <p class="text-muted">Powered by <a href="http://spotify.com">Spotify</a>.</p>
  </div>
</div>

<script src="lib/jquery-1.11.1.min.js"></script>
<script src="lib/bootstrap.min.js"></script>
<script src="lib/underscore-min.js"></script>

<!-- Minified Playlist Builder JS with corrected login -->
<script>
"use strict";
// ... all your existing minified JS here, unchanged ...
// just replace the loginWithSpotify function with this:
function loginWithSpotify() {
    var client_id = 'd36e30807e5c4cd68c64b3d30789bc8a';
    var redirect_uri;

    if (document.location.hostname === 'localhost') {
        redirect_uri = 'http://localhost:8000/';
    } else {
        redirect_uri = 'https://renjgarcia1.github.io/playlist-builder/';
    }

    var scopes = 'playlist-modify-public';

    var url = 'https://accounts.spotify.com/authorize?client_id=' + client_id +
        '&response_type=token' +
        '&scope=' + encodeURIComponent(scopes) +
        '&redirect_uri=' + encodeURIComponent(redirect_uri);

    document.location = url;
}
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-3675615-45', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
